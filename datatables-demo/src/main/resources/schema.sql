CREATE TABLE IF NOT EXISTS AIRPORTS
(
    ID NUMBER(9),
    IDENT VARCHAR(10),
    AIRPORT_TYPE VARCHAR(100),
    AIRPORT_NAME VARCHAR2(1000),
    LATITUDE_DEG NUMBER(20, 10),
    LONGITUDE_DEG NUMBER(20, 10),
    ELEVATION_FT  NUMBER(10, 2),
    CONTINENT VARCHAR(10),
    ISO_COUNTRY VARCHAR(10),
    ISO_REGION VARCHAR(10),
    MUNICIPALITY VARCHAR(100),
    SCHEDULED_SERVICE VARCHAR(10),
    GPS_CODE VARCHAR(10),
    IATA_CODE VARCHAR(10),
    LOCAL_CODE VARCHAR(10),
    HOME_LINK VARCHAR(1000),
    WIKIPEDIA_LINK VARCHAR(1000),
    KEYWORDS VARCHAR(1000),
    LAST_UPDATE TIMESTAMP
)
AS
SELECT CONVERT(ID,NUMBER) AS ID,
       IDENT,
       TYPE AS AIRPORT_TYPE,
       NAME AS AIRPORT_NAME,
       CONVERT(LATITUDE_DEG, NUMBER) AS LATITUDE_DEG,
       CONVERT(LONGITUDE_DEG, NUMBER) AS LONGITUDE_DEG,
       CONVERT(ELEVATION_FT, NUMBER) AS ELEVATION_FT,
       CONTINENT,
       ISO_COUNTRY,
       ISO_REGION,
       MUNICIPALITY,
       SCHEDULED_SERVICE,
       GPS_CODE,
       IATA_CODE,
       LOCAL_CODE,
       HOME_LINK,
       WIKIPEDIA_LINK,
       KEYWORDS,
       SYSDATE
FROM CSVREAD('classpath:/airports.csv', NULL, 'charset=UTF-8');